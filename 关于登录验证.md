# 用户访问网页的流程  
```
1.用户登录  
2.用户访问  
3.登录失效 
4.用户退出
```
## 1. 用户登录  
后台返回给前端一个唯一的标识符token或sessionID，前端将得到的标识符储存在cookies中，并将路由跳转到首页。  
## 2. 用户访问  
用户访问任何页面时在全局的钩子函数中取用用户登录标识，存在才会继续路由跳转，不存在的话将路由定向到登录界面，此时所有的请求应当携带登录标识符，后台用来判断登录权限。  
## 3. 登录失效  
后台一般会设置用户登录失效的，一段时间内用户不进行操作，session会过期，此时用户再次访问后台接口时后台应作出响应，返回一个过期的code码，前端拦截code码，清除
cookies并将路由定向登录页面。  
## 4. 用户退出  
退出时清空cookies，路由定向到登录页面，避免路由bug也可以刷新界面。  
# Token  
## 一、什么是Token？  
### 1. token的引入    
客户端频繁地向服务器请求数据，服务器频繁的去数据库查询用户名和密码，判断用户名和密码是否
正确，并作出相应的提示。为了减少数据查询的复杂度，将查询时用户名和密码的绑定
改为token的绑定。  
### 2. Token的定义  
Token是服务器端生成的一串字符串，以作为客户端请求的一个令牌，当一次登录后，服务器生成一个Token
并将此Token返回给客户端，以后客户端只需带上这个Token前来请求数据即可，无需再次带上用户名
和密码。  
### 3. 使用Token的目的  
Token的目的是为了减轻服务器的压力，减少频繁的查询数据库，使服务器更加健壮。  
## 二、如何使用Token？  
### 1. 用设备号/ 设备mac地址作为Token（推荐）  
客户端：客户端在登录的时候获取设备的设备号/mac地址，并将其作为参数传递到服务端。  
服务端：服务端接收到该参数后，便用一个变量来接收同时将其作为Token保存在数据库，并将该Token
设置到session中，客户端每次请求的时候都要统一拦截，并将客户端的token和服务器中的token进行
对比，如果相同则放行，否则将拒绝；  
分析：此时客户端和服务器就统一了一个唯一的标识Token，而且保证了每一个设备拥有了一个唯一
会话。该方法的缺点是客户端需要带设备号/mac地址作为参数传递，而且服务器端还需要保存；优点
是客户端不需要重新登录，只要登录一次以后就可以一直使用，至于超时的问题是由服务器这边来处理，
若服务器的Token超时后，服务器只需将客户端传递的Token向数据库中查询，同时并赋值给变量Token，如此，Token
的超时又重新计时。  
### 2. 用session值作为Token  
客户端：客户端只需携带用户名和密码登录即可。  
服务端：服务端接收到用户名和密码后并判断，如果正确了就将本地获取的sessionID作为Token返回给客户端，
客户端以后只需带上请求数据即可。  
分析：这种方式使用的好处是方便，不用存储数据，但是缺点就是当session过期后，客户端必须重
新登录才能进行访问数据。  
## 三、使用过程中出现的问题以及解决方案？  
第一种方法中我们隐藏了一个在网络不好或者并发请求时会导致多次重复提交数据的问题。  
解决方案是：将session和Token套用。  
```
    session 是一个在单个操作人员整个操作过程中，与服务器端保持通信的唯一识别信息。在同一操作
人员的多次请求当中，session始终保证是同一个对象，而不是多个对象，因为可以对其加锁。当同一
操作人员多个请求进入时，可以通过session限制只能单向通行。
    通过使用session以及在session中加入token，可以验证同一个操作人员是否进行了并发重复
 的请求，在后一个请求到来时，使用session中的token验证请求中的token是否一致，当不一致时，被
 认为是重复提交，将不准许通过。
 ```
 
